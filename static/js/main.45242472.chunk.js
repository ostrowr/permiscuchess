(this.webpackJsonppermiscuchess=this.webpackJsonppermiscuchess||[]).push([[0],{65:function(e,t,n){},66:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);var i=n(2),r=n(1),a=n.n(r),c=n(23),s=n.n(c),o=(n(65),n(28)),l=n(10),j=(n(66),n(9)),d=n(50);function h(){return new Worker(n.p+"static/js/worker.d69aae68.worker.js")}var b=function(){for(var e=[],t=navigator.hardwareConcurrency,n=0;n<t;n++)console.log("instantiating new worker"),e.push(new h);return e}(),u=function(e){var t=!!window.Worker,n=e.onGameComplete;return Object(r.useEffect)((function(){b.forEach((function(e){return e.onmessage=function(e){return n(e.data)}}))}),[n]),Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)(j.a,{disabled:0===b.length,onClick:function(){for(var t=0;t<e.nGamesToSimulate;t++)e.onSimulationStart(),b[t%b.length].postMessage(e.strategies)},children:["Simulate ",e.nGamesToSimulate," game",1===e.nGamesToSimulate?"":"s",t?"":" (cannot simulate; no web workers)"]})})},g=function(e){if(0===e.nPending)return null;var t=1===e.nPending?"simulation":"simulations";return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(d.a,{animation:"grow",size:"sm"})," ",Object(i.jsx)("span",{children:" ".concat(e.nPending," ").concat(t," pending...")})]})},O=n(51),x=n.n(O),m=(n(25),n(52),n(53),n(54),["pa","pb","pc","pd","pe","pf","pg","ph","ra","rh","nb","ng","bc","bf","k","q"]),f=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"],p=m.flatMap((function(e){return f.map((function(t){return{piece:e,destination:t}}))})),y=function(){return function(e){for(var t=Object(o.a)(e),n=t.length-1;n>0;n--){var i=Math.floor(Math.random()*(n+1)),r=[t[i],t[n]];t[n]=r[0],t[i]=r[1]}return t}(p)};var v=n(45),w=n(11),k=n(26),S=n(55),C=n(27),F=function(e){var t=Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"#"}),Object(i.jsx)("th",{children:"Outcome"}),Object(i.jsx)("th",{children:"By"})]})}),n=e.games.map((function(t,n){return Object(i.jsxs)("tr",{onClick:function(){return e.onRowClick(t,n)},children:[Object(i.jsx)("td",{children:n}),Object(i.jsx)("td",{children:t.outcome}),Object(i.jsx)("td",{children:t.by})]},n)}));return 0===n.length?Object(i.jsx)(C.a,{variant:"info",children:"No games played yet!"}):Object(i.jsxs)(S.a,{bordered:!0,hover:!0,size:"sm",children:[t,Object(i.jsx)("tbody",{children:n.reverse()})]})},T=n(56),B=n.n(T),H=n(8),P=n(34),G=function(e){var t=e.games.filter((function(e){return"White wins"===e.outcome})).length,n=e.games.filter((function(e){return"Black wins"===e.outcome})).length,r=e.games.filter((function(e){return"Draw"===e.outcome})).length,a=(100*t/e.games.length).toFixed(1),c=(100*n/e.games.length).toFixed(1),s=(100*r/e.games.length).toFixed(1),o=[{x:["White wins","Black wins"],y:[t,n],name:"checkmate/forfeit",type:"bar"},{x:["Draw"],y:[e.games.filter((function(e){return"fifty move rule"===e.by})).length],name:"fifty move rule",type:"bar"},{x:["Draw"],y:[e.games.filter((function(e){return"stalemate"===e.by})).length],name:"stalemate",type:"bar"},{x:["Draw"],y:[e.games.filter((function(e){return"insufficient material"===e.by})).length],name:"insufficient material",type:"bar"},{x:["Draw"],y:[e.games.filter((function(e){return"threefold repetition"===e.by})).length],name:"threefold repetiion",type:"bar"}];return Object(i.jsxs)(H.a,{show:e.show,onHide:e.onHide,children:[Object(i.jsx)(H.a.Header,{closeButton:!0,children:Object(i.jsx)(H.a.Title,{children:"Stats"})}),Object(i.jsx)(H.a.Body,{children:e.games.length>0?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(P.a,{style:{padding:10},children:Object(i.jsxs)("h4",{children:["White: ",a,"%; Black: ",c,"%; Draw:"," ",s,"%"]})}),Object(i.jsx)(B.a,{data:o,layout:{barmode:"stack",width:480}})]}):Object(i.jsx)(P.a,{style:{padding:10},children:Object(i.jsx)("h4",{children:"No games played"})})})]})},z=n(40),E=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),a=n[0],c=n[1],s=e.games.map((function(e,t){return[t,e.outcome,e.by,e.pgn]}));return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(w.a,{style:{height:500},children:Object(i.jsxs)(w.a.Body,{children:[Object(i.jsx)(w.a.Title,{children:"History"}),Object(i.jsx)(w.a.Subtitle,{children:"All games played"}),Object(i.jsx)(w.a.Text,{children:Object(i.jsxs)(k.a,{children:[Object(i.jsx)(j.a,{onClick:function(){return e.setGames([])},size:"sm",variant:"info",children:"Clear"}),Object(i.jsx)(j.a,{onClick:function(){return c(!0)},size:"sm",variant:"light",children:"Stats"}),Object(i.jsx)(z.CSVLink,{data:[["#","Outcome","By","PGN"]].concat(Object(o.a)(s)),filename:"permiscuchess-results.csv",children:Object(i.jsx)(j.a,{size:"sm",variant:"dark",children:"Download"})})]})}),Object(i.jsx)("div",{style:{maxHeight:350,overflow:"scroll"},children:Object(i.jsx)(F,{games:e.games,onRowClick:function(t,n){return e.setCurrentGame(Object(v.a)(Object(v.a)({},t),{},{gameIndex:n}))}})})]})}),Object(i.jsx)(G,{games:e.games,onHide:function(){return c(!1)},show:a})]})},I=function(e){return Object(i.jsxs)(H.a,{show:e.show,onHide:e.onHide,children:[Object(i.jsx)(H.a.Header,{closeButton:!0,children:Object(i.jsx)(H.a.Title,{children:"How to Play"})}),Object(i.jsxs)(H.a.Body,{children:[Object(i.jsx)("p",{children:"Permiscuchess is a chess variant that is entirely pre-played. Instead of a real-time battle of wits, Permiscuchess is played by devising a clever strategy."}),Object(i.jsx)("h2",{children:"Defining a strategy"}),Object(i.jsxs)("p",{children:["Each piece on a Permiscuchess board is labeled according to its starting file. For example, ",Object(i.jsx)("code",{children:"pb"})," is the pawn that starts on file ",Object(i.jsx)("code",{children:"b"}),". ",Object(i.jsx)("code",{children:"pb"})," will continue to identify that pawn throughout the game, even if it moves off of the ",Object(i.jsx)("code",{children:"b"})," ","file or if it is promoted."]}),Object(i.jsxs)("p",{children:["A strategy is just a list of moves specifying a piece and a destination square. For example, ",Object(i.jsx)("code",{children:"pa:b5"}),' is a move that says "move the piece with identifier ',Object(i.jsx)("code",{children:"pa"})," to square"," ",Object(i.jsx)("code",{children:"b5"}),'."']}),Object(i.jsx)("p",{children:"Most moves in your strategy are likely to be illegal at most points in the game. Each turn, the computer chooses the next legal move in your strategy, looping around if it gets to the end."}),Object(i.jsx)("p",{children:"There are 960 possible permiscuchess moves. All pieces except bishops can explore the whole board, and bishops can only explore their color. You may repeat moves in your strategy \u2013 that is, your strategy does not need to be exactly 960 moves long."}),Object(i.jsxs)("p",{children:["The piece identifiers are:",Object(i.jsx)("p",{children:Object(i.jsxs)("code",{children:["Pawns: pa pb pc pd pe pf pg ph ",Object(i.jsx)("br",{}),"Rooks: ra rh ",Object(i.jsx)("br",{}),"Knights: nb ng ",Object(i.jsx)("br",{}),"Bishops: bc bf ",Object(i.jsx)("br",{}),"King: k ",Object(i.jsx)("br",{}),"Queen: q ",Object(i.jsx)("br",{})]})})]}),Object(i.jsx)("h2",{children:"Gameplay"}),"The computer plays a single turn in Permiscuchess by following these steps:",Object(i.jsxs)("ol",{children:[Object(i.jsx)("li",{children:"Select the next legal move in the current player's strategy, looping to the beginning if necessary. If there are no legal moves in the whole strategy, the current player forfeits."}),Object(i.jsx)("li",{children:"Make the move."}),Object(i.jsx)("li",{children:"If the move ended in checkmate or draw (by threefold repetition, stalemate, insufficient material, or 50 moves without a capture), end the game."}),Object(i.jsx)("li",{children:"Go to the other player's turn and repeat."})]}),"Permiscuchess is played just like normal chess, with a few caveats:",Object(i.jsxs)("ul",{children:[Object(i.jsx)("li",{children:"If a pawn reaches the eigth rank, it is automatically promoted to a queen."}),Object(i.jsx)("li",{children:"There is no castling."})]}),Object(i.jsx)("h2",{children:"Tips"}),Object(i.jsxs)("ol",{children:[Object(i.jsx)("li",{children:'You should never have to forfeit. There are only 960 possible moves, and at least one of them must be legal until the game is over! "Randomize" just shuffles those moves for you.'}),Object(i.jsx)("li",{children:'On average, random strategies playing against one another each win about 13% of the time, with the remaining 74% of games drawn. Can you find a strategy that wins 20% of its games? Click on "Stats" to see how you\'re doing.'}),Object(i.jsx)("li",{children:"You can adjust the slider at the bottom to simulate between 1 and 1000 games at a time against randomly generated opponents."}),Object(i.jsx)("li",{children:"Try clicking on the PGN of a game you're viewing to view it in Lichess!"})]})]})]})},D=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),a=n[0],c=n[1];return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsxs)(P.a,{style:{padding:10},children:[Object(i.jsx)("h1",{children:"Permiscuchess"}),Object(i.jsx)("p",{children:"By Robbie Ostrow"}),Object(i.jsx)(j.a,{variant:"outline-primary",size:"sm",onClick:function(){return c(!0)},children:"How to Play"})]}),Object(i.jsx)(I,{show:a,onHide:function(){return c(!1)}})]})},M=n(35),R=function(e){var t=e.moves.map((function(e,t){return{id:t+1,piece:Object(i.jsx)("strong",{children:q(e.piece)}),destination:Object(i.jsx)("strong",{children:e.destination})}}));return Object(i.jsxs)(M.b,{data:t,width:360,height:350,children:[Object(i.jsx)(M.a,{dataKey:"id",width:100,title:"Turn"},"id"),Object(i.jsx)(M.a,{dataKey:"piece",width:100,title:"Piece"},"piece"),Object(i.jsx)(M.a,{dataKey:"destination",width:100,title:"Destination"},"destination")]})},q=function(e){var t={n:"Knight",q:"Queen",p:"Pawn",r:"Rook",b:"Bishop",k:"King"}[e[0]];return 1===e.length?t:"".concat(t," (").concat(e[1],")")};var K=function(e){var t=e.split(":"),n=Object(l.a)(t,2),i=n[0],r=n[1];return function(e){if(!m.includes(e))throw new Error("Invalid piece identifier: ".concat(e))}(i),function(e){if(!f.includes(e))throw new Error("Invalid square: ".concat(e))}(r),{piece:i,destination:r}},L=n(41),N=n(21),W=n(30),A=function(e){var t=e.strategy,n=Object(r.useState)(void 0),a=Object(l.a)(n,2),c=a[0],s=a[1];Object(r.useEffect)((function(){var e=null===t||void 0===t?void 0:t.map((function(e){return["".concat(e.piece,":").concat(e.destination)]})).join("\n");s(e)}),[t]);var o=function(e){if(!e)return!1;var t=e.split(/\s+/).filter((function(e){return e.length>0}));try{return t.map(K)}catch(n){return!1}}(c);return Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)(H.a,{show:e.show,onHide:e.onHide,children:[Object(i.jsx)(H.a.Header,{closeButton:!0,children:Object(i.jsx)(H.a.Title,{children:"Edit Strategy"})}),Object(i.jsx)(H.a.Body,{children:Object(i.jsx)(L.a,{children:Object(i.jsxs)(W.a,{children:[Object(i.jsx)(N.a,{children:"Edit your strategy by adding or re-ordering moves here."}),Object(i.jsx)(N.a,{children:Object(i.jsx)("textarea",{value:c,onChange:function(e){return s(e.target.value)},rows:20,placeholder:"paste strategy here",spellCheck:!1})})]})})}),Object(i.jsx)(H.a.Footer,{children:Object(i.jsx)(j.a,{variant:"secondary",disabled:!o,onClick:function(){o&&e.onSave(o)},children:o?"Save":"Invalid strategy"})})]})})},Y=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),a=n[0],c=n[1],s=e.strategy.map((function(e){return["".concat(e.piece,":").concat(e.destination)]}));return Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(w.a,{style:{height:500},children:Object(i.jsxs)(w.a.Body,{children:[Object(i.jsx)(w.a.Title,{children:"Strategy"}),Object(i.jsxs)(w.a.Subtitle,{children:["Setting strategy for"," ",Object(i.jsx)("span",{style:{color:"gray",cursor:"pointer"},onClick:function(){return e.setStrategyFor((function(e){return"w"===e?"b":"b"===e?null:"w"}))},children:"w"===e.strategyFor?"white":"b"===e.strategyFor?"black":"neither player"})]}),null!==e.strategyFor?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(w.a.Text,{children:Object(i.jsxs)(k.a,{children:[Object(i.jsx)(j.a,{size:"sm",onClick:function(){return e.setStrategy(y())},variant:"info",children:"Randomize"}),Object(i.jsx)(j.a,{size:"sm",onClick:function(){return c(!0)},variant:"light",children:"Edit"}),Object(i.jsx)(z.CSVLink,{data:s,filename:"permiscuchess-strategy.txt",children:Object(i.jsx)(j.a,{size:"sm",variant:"dark",children:"Export"})})]})}),Object(i.jsx)(R,{moves:e.strategy,draggable:!0})]}):Object(i.jsx)(C.a,{variant:"info",children:'Both players are playing randomly. Click "neither player" above to set a strategy for Black or White.'})]})}),Object(i.jsx)(A,{show:a,onHide:function(){return c(!1)},onSave:function(t){e.setStrategy(t),c(!1)},strategy:e.strategy})]})},J=n(58),Q=n.n(J),V=n(46),U=n.n(V),X=n(59),Z=function(e){var t=Object(r.useState)(!1),n=Object(l.a)(t,2),a=n[0],c=n[1];return Object(i.jsxs)(H.a,{show:e.show,onHide:e.onHide,children:[Object(i.jsx)(H.a.Header,{closeButton:!0,children:Object(i.jsx)(H.a.Title,{children:"PGN"})}),Object(i.jsx)(H.a.Body,{children:e.pgn}),Object(i.jsxs)(H.a.Footer,{children:[Object(i.jsx)(j.a,{variant:"secondary",onClick:function(){e.pgn&&navigator.clipboard.writeText(e.pgn)},children:"Copy"}),Object(i.jsx)(j.a,{variant:"secondary",disabled:a,onClick:Object(X.a)(U.a.mark((function t(){var n,i,r;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c(!0),t.next=3,fetch("https://lichess.org/api/import",{method:"POST",body:new URLSearchParams({pgn:e.pgn})});case 3:return n=t.sent,t.next=6,n.json();case 6:i=t.sent,r=i.url,c(!1),window.open(r);case 10:case"end":return t.stop()}}),t)}))),children:"Open in Lichess"})]})]})},$=function(e){return Object(i.jsxs)(H.a,{show:e.show,onHide:e.onHide,children:[Object(i.jsx)(H.a.Header,{closeButton:!0,children:Object(i.jsx)(H.a.Title,{children:"Strategy"})}),Object(i.jsx)(H.a.Body,{children:Object(i.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:e.strategy?Object(i.jsx)(R,{moves:e.strategy,draggable:!1}):null})}),Object(i.jsx)(H.a.Footer,{children:Object(i.jsx)(j.a,{variant:"secondary",onClick:e.onHide,children:"Close"})})]})},_=function(e){var t=Object(r.useState)(void 0),n=Object(l.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(void 0),o=Object(l.a)(s,2),d=o[0],h=o[1];return e.game?Object(i.jsxs)(i.Fragment,{children:[Object(i.jsx)(w.a,{style:{height:500},children:Object(i.jsxs)(w.a.Body,{children:[Object(i.jsx)(w.a.Title,{children:"Game ".concat(e.game.gameIndex)}),Object(i.jsx)(w.a.Subtitle,{children:"".concat(e.game.outcome," by ").concat(e.game.by)}),Object(i.jsx)(w.a.Text,{children:Object(i.jsxs)(k.a,{children:[Object(i.jsx)(j.a,{onClick:function(){var t;return c(null===(t=e.game)||void 0===t?void 0:t.pgn)},size:"sm",variant:"info",children:"PGN"}),Object(i.jsx)(j.a,{onClick:function(){var t;return h(null===(t=e.game)||void 0===t?void 0:t.whiteStrategy)},size:"sm",variant:"light",children:"White strategy"}),Object(i.jsx)(j.a,{onClick:function(){var t;return h(null===(t=e.game)||void 0===t?void 0:t.blackStrategy)},size:"sm",variant:"dark",children:"Black strategy"})]})}),Object(i.jsx)(Q.a,{width:358,draggable:!1,position:e.game.fen,boardStyle:{borderRadius:"5px",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.5)"}})]})}),Object(i.jsx)(Z,{pgn:a,onHide:function(){return c(void 0)},show:void 0!==a}),Object(i.jsx)($,{strategy:d,onHide:function(){return h(void 0)},show:void 0!==d})]}):Object(i.jsx)(w.a,{style:{height:500},children:Object(i.jsxs)(w.a.Body,{children:[Object(i.jsx)(w.a.Title,{children:"No game selected"}),Object(i.jsx)(C.a,{variant:"info",children:'Select a game from the "History" section'})]})})};var ee=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),s=Object(l.a)(c,2),j=s[0],d=s[1],h=Object(r.useState)(0),b=Object(l.a)(h,2),O=b[0],m=b[1],f=Object(r.useState)(1),y=Object(l.a)(f,2),v=y[0],w=y[1],k=Object(r.useState)(p),S=Object(l.a)(k,2),C=S[0],F=S[1],T=Object(r.useState)(null),B=Object(l.a)(T,2),H=B[0],P=B[1];return Object(i.jsx)(i.Fragment,{children:Object(i.jsxs)(L.a,{fluid:!0,children:[Object(i.jsx)(W.a,{children:Object(i.jsx)(N.a,{children:Object(i.jsx)(D,{})})}),Object(i.jsxs)(W.a,{children:[Object(i.jsx)(N.a,{children:Object(i.jsx)(_,{game:j})}),Object(i.jsx)(N.a,{children:Object(i.jsx)(Y,{strategy:C,setStrategy:F,strategyFor:H,setStrategyFor:P})}),Object(i.jsx)(N.a,{children:Object(i.jsx)(E,{games:n,setGames:a,setCurrentGame:d})})]}),Object(i.jsx)(W.a,{children:Object(i.jsxs)(N.a,{children:[Object(i.jsx)(u,{nGamesToSimulate:v,onGameComplete:function(e){a((function(t){return[].concat(Object(o.a)(t),[e])})),m((function(e){return e-1}))},onSimulationStart:function(){return m((function(e){return e+1}))},strategies:{blackMoves:"b"===H?C:void 0,whiteMoves:"w"===H?C:void 0}}),Object(i.jsx)(g,{nPending:O}),Object(i.jsx)("div",{style:{width:150},children:Object(i.jsx)(x.a,{value:v,onChange:function(e){return w(parseInt(e.target.value,10))},min:1,max:1e3})})]})})]})})},te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,85)).then((function(t){var n=t.getCLS,i=t.getFID,r=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),i(e),r(e),a(e),c(e)}))};n(80),n(81),n(82);s.a.render(Object(i.jsx)(a.a.StrictMode,{children:Object(i.jsx)(ee,{})}),document.getElementById("root")),te()}},[[83,1,2]]]);
//# sourceMappingURL=main.45242472.chunk.js.map