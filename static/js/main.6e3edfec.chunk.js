(this.webpackJsonppermiscuchess=this.webpackJsonppermiscuchess||[]).push([[0],{65:function(e,t,n){},66:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);var c=n(2),r=n(1),a=n.n(r),i=n(23),s=n.n(i),o=(n(65),n(28)),j=n(11),l=(n(66),n(9)),d=n(50);function h(){return new Worker(n.p+"static/js/worker.0d24494e.worker.js")}var u=function(){for(var e=[],t=navigator.hardwareConcurrency,n=0;n<t;n++)console.log("instantiating new worker"),e.push(new h);return e}(),b=function(e){var t=!!window.Worker,n=e.onGameComplete;return Object(r.useEffect)((function(){u.forEach((function(e){return e.onmessage=function(e){return n(e.data)}}))}),[n]),Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(l.a,{disabled:0===u.length,onClick:function(){for(var t=0;t<e.nGamesToSimulate;t++)e.onSimulationStart(),u[t%u.length].postMessage(e.strategies)},children:["Simulate ",e.nGamesToSimulate," game",1===e.nGamesToSimulate?"":"s",t?"":" (cannot simulate; no web workers)"]})})},O=function(e){if(0===e.nPending)return null;var t=1===e.nPending?"simulation":"simulations";return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(d.a,{animation:"grow",size:"sm"})," ",Object(c.jsx)("span",{children:" ".concat(e.nPending," ").concat(t," pending...")})]})},g=n(51),x=n.n(g),f=(n(25),n(52),n(53),n(54),["pa","pb","pc","pd","pe","pf","pg","ph","ra","rh","nb","ng","bc","bf","k","q"]),m=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"],y=f.flatMap((function(e){return m.map((function(t){return{piece:e,destination:t}}))})),p=function(){return function(e){for(var t=Object(o.a)(e),n=t.length-1;n>0;n--){var c=Math.floor(Math.random()*(n+1)),r=[t[c],t[n]];t[n]=r[0],t[c]=r[1]}return t}(y)};var v=n(45),w=n(10),S=n(26),k=n(55),C=n(27),F=function(e){var t=Object(c.jsx)("thead",{children:Object(c.jsxs)("tr",{children:[Object(c.jsx)("th",{children:"#"}),Object(c.jsx)("th",{children:"Outcome"}),Object(c.jsx)("th",{children:"By"})]})}),n=e.games.map((function(t,n){return Object(c.jsxs)("tr",{onClick:function(){return e.onRowClick(t,n)},children:[Object(c.jsx)("td",{children:n}),Object(c.jsx)("td",{children:t.outcome}),Object(c.jsx)("td",{children:t.by})]},n)}));return 0===n.length?Object(c.jsx)(C.a,{variant:"info",children:"No games played yet!"}):Object(c.jsxs)(k.a,{bordered:!0,hover:!0,size:"sm",children:[t,Object(c.jsx)("tbody",{children:n.reverse()})]})},B=n(56),T=n.n(B),H=n(8),G=n(34),P=function(e){var t=e.games.filter((function(e){return"White wins"===e.outcome})).length,n=e.games.filter((function(e){return"Black wins"===e.outcome})).length,r=e.games.filter((function(e){return"Draw"===e.outcome})).length,a=(100*t/e.games.length).toFixed(1),i=(100*n/e.games.length).toFixed(1),s=(100*r/e.games.length).toFixed(1),o=[{x:["White wins","Black wins"],y:[t,n],name:"checkmate",type:"bar"},{x:["Draw"],y:[e.games.filter((function(e){return"fifty move rule"===e.by})).length],name:"fifty move rule",type:"bar"},{x:["Draw"],y:[e.games.filter((function(e){return"stalemate"===e.by})).length],name:"stalemate",type:"bar"},{x:["Draw"],y:[e.games.filter((function(e){return"insufficient material"===e.by})).length],name:"insufficient material",type:"bar"},{x:["Draw"],y:[e.games.filter((function(e){return"threefold repetition"===e.by})).length],name:"threefold repetiion",type:"bar"}];return Object(c.jsxs)(H.a,{show:e.show,onHide:e.onHide,children:[Object(c.jsx)(H.a.Header,{closeButton:!0,children:Object(c.jsx)(H.a.Title,{children:"Stats"})}),Object(c.jsx)(H.a.Body,{children:e.games.length>0?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(G.a,{style:{padding:10},children:Object(c.jsxs)("h4",{children:["White: ",a,"%; Black: ",i,"%; Draw:"," ",s,"%"]})}),Object(c.jsx)(T.a,{data:o,layout:{barmode:"stack",width:480}})]}):Object(c.jsx)(G.a,{style:{padding:10},children:Object(c.jsx)("h4",{children:"No games played"})})})]})},z=n(40),D=function(e){var t=Object(r.useState)(!1),n=Object(j.a)(t,2),a=n[0],i=n[1],s=e.games.map((function(e,t){return[t,e.outcome,e.by,e.pgn]}));return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(w.a,{style:{height:500},children:Object(c.jsxs)(w.a.Body,{children:[Object(c.jsx)(w.a.Title,{children:"History"}),Object(c.jsx)(w.a.Subtitle,{children:"All games played"}),Object(c.jsx)(w.a.Text,{children:Object(c.jsxs)(S.a,{children:[Object(c.jsx)(l.a,{onClick:function(){return e.setGames([])},size:"sm",variant:"info",children:"Clear"}),Object(c.jsx)(l.a,{onClick:function(){return i(!0)},size:"sm",variant:"light",children:"Stats"}),Object(c.jsx)(z.CSVLink,{data:[["#","Outcome","By","PGN"]].concat(Object(o.a)(s)),filename:"permiscuchess-results.csv",children:Object(c.jsx)(l.a,{size:"sm",variant:"dark",children:"Download"})})]})}),Object(c.jsx)("div",{style:{maxHeight:350,overflow:"scroll"},children:Object(c.jsx)(F,{games:e.games,onRowClick:function(t,n){return e.setCurrentGame(Object(v.a)(Object(v.a)({},t),{},{gameIndex:n}))}})})]})}),Object(c.jsx)(P,{games:e.games,onHide:function(){return i(!1)},show:a})]})},E=function(e){return Object(c.jsxs)(G.a,{style:{padding:10},children:[Object(c.jsx)("h1",{children:"Permiscuchess"}),Object(c.jsx)("p",{children:"TODO"})]})},I=n(35),M=function(e){var t=e.moves.map((function(e,t){return{id:t+1,piece:Object(c.jsx)("strong",{children:W(e.piece)}),destination:Object(c.jsx)("strong",{children:e.destination})}}));return Object(c.jsxs)(I.b,{data:t,width:360,height:350,children:[Object(c.jsx)(I.a,{dataKey:"id",width:100,title:"Turn"},"id"),Object(c.jsx)(I.a,{dataKey:"piece",width:100,title:"Piece"},"piece"),Object(c.jsx)(I.a,{dataKey:"destination",width:100,title:"Destination"},"destination")]})},W=function(e){var t={n:"Knight",q:"Queen",p:"Pawn",r:"Rook",b:"Bishop",k:"King"}[e[0]];return 1===e.length?t:"".concat(t," (").concat(e[1],")")};var L=function(e){var t=e.split(":"),n=Object(j.a)(t,2),c=n[0],r=n[1];return function(e){if(!f.includes(e))throw new Error("Invalid piece identifier: ".concat(e))}(c),function(e){if(!m.includes(e))throw new Error("Invalid square: ".concat(e))}(r),{piece:c,destination:r}},N=n(41),R=n(21),K=n(30),q=function(e){var t=e.strategy,n=Object(r.useState)(void 0),a=Object(j.a)(n,2),i=a[0],s=a[1];Object(r.useEffect)((function(){var e=null===t||void 0===t?void 0:t.map((function(e){return["".concat(e.piece,":").concat(e.destination)]})).join("\n");s(e)}),[t]);var o=function(e){if(!e)return!1;var t=e.split(/\s+/).filter((function(e){return e.length>0}));try{return t.map(L)}catch(n){return!1}}(i);return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(H.a,{show:e.show,onHide:e.onHide,children:[Object(c.jsx)(H.a.Header,{closeButton:!0,children:Object(c.jsx)(H.a.Title,{children:"Edit Strategy"})}),Object(c.jsx)(H.a.Body,{children:Object(c.jsx)(N.a,{children:Object(c.jsxs)(K.a,{children:[Object(c.jsx)(R.a,{children:"TODO"}),Object(c.jsx)(R.a,{children:Object(c.jsx)("textarea",{value:i,onChange:function(e){return s(e.target.value)},rows:20,placeholder:"paste strategy here",spellCheck:!1})})]})})}),Object(c.jsx)(H.a.Footer,{children:Object(c.jsx)(l.a,{variant:"secondary",disabled:!o,onClick:function(){o&&e.onSave(o)},children:o?"Save":"Invalid strategy"})})]})})},J=function(e){var t=Object(r.useState)(!1),n=Object(j.a)(t,2),a=n[0],i=n[1],s=e.strategy.map((function(e){return["".concat(e.piece,":").concat(e.destination)]}));return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(w.a,{style:{height:500},children:Object(c.jsxs)(w.a.Body,{children:[Object(c.jsx)(w.a.Title,{children:"Strategy"}),Object(c.jsxs)(w.a.Subtitle,{children:["Setting strategy for"," ",Object(c.jsx)("span",{style:{color:"gray",cursor:"pointer"},onClick:function(){return e.setStrategyFor((function(e){return"w"===e?"b":"b"===e?null:"w"}))},children:"w"===e.strategyFor?"white":"b"===e.strategyFor?"black":"neither player"})]}),null!==e.strategyFor?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(w.a.Text,{children:Object(c.jsxs)(S.a,{children:[Object(c.jsx)(l.a,{size:"sm",onClick:function(){return e.setStrategy(p())},variant:"info",children:"Randomize"}),Object(c.jsx)(l.a,{size:"sm",onClick:function(){return i(!0)},variant:"light",children:"Edit"}),Object(c.jsx)(z.CSVLink,{data:s,filename:"permiscuchess-strategy.txt",children:Object(c.jsx)(l.a,{size:"sm",variant:"dark",children:"Export"})})]})}),Object(c.jsx)(M,{moves:e.strategy,draggable:!0})]}):Object(c.jsx)(C.a,{variant:"info",children:'Both players are playing randomly. Click "neither player" above to set a strategy for Black or White.'})]})}),Object(c.jsx)(q,{show:a,onHide:function(){return i(!1)},onSave:function(t){e.setStrategy(t),i(!1)},strategy:e.strategy})]})},V=n(58),A=n.n(V),Q=n(46),U=n.n(Q),X=n(59),Y=function(e){var t=Object(r.useState)(!1),n=Object(j.a)(t,2),a=n[0],i=n[1];return Object(c.jsxs)(H.a,{show:e.show,onHide:e.onHide,children:[Object(c.jsx)(H.a.Header,{closeButton:!0,children:Object(c.jsx)(H.a.Title,{children:"PGN"})}),Object(c.jsx)(H.a.Body,{children:e.pgn}),Object(c.jsxs)(H.a.Footer,{children:[Object(c.jsx)(l.a,{variant:"secondary",onClick:function(){e.pgn&&navigator.clipboard.writeText(e.pgn)},children:"Copy"}),Object(c.jsx)(l.a,{variant:"secondary",disabled:a,onClick:Object(X.a)(U.a.mark((function t(){var n,c,r;return U.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i(!0),t.next=3,fetch("https://lichess.org/api/import",{method:"POST",body:new URLSearchParams({pgn:e.pgn})});case 3:return n=t.sent,t.next=6,n.json();case 6:c=t.sent,r=c.url,i(!1),window.open(r);case 10:case"end":return t.stop()}}),t)}))),children:"Open in Lichess"})]})]})},Z=function(e){return Object(c.jsxs)(H.a,{show:e.show,onHide:e.onHide,children:[Object(c.jsx)(H.a.Header,{closeButton:!0,children:Object(c.jsx)(H.a.Title,{children:"Strategy"})}),Object(c.jsx)(H.a.Body,{children:Object(c.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:e.strategy?Object(c.jsx)(M,{moves:e.strategy,draggable:!1}):null})}),Object(c.jsx)(H.a.Footer,{children:Object(c.jsx)(l.a,{variant:"secondary",onClick:e.onHide,children:"Close"})})]})},$=function(e){var t=Object(r.useState)(void 0),n=Object(j.a)(t,2),a=n[0],i=n[1],s=Object(r.useState)(void 0),o=Object(j.a)(s,2),d=o[0],h=o[1];return e.game?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(w.a,{style:{height:500},children:Object(c.jsxs)(w.a.Body,{children:[Object(c.jsx)(w.a.Title,{children:"Game ".concat(e.game.gameIndex)}),Object(c.jsx)(w.a.Subtitle,{children:"".concat(e.game.outcome," by ").concat(e.game.by)}),Object(c.jsx)(w.a.Text,{children:Object(c.jsxs)(S.a,{children:[Object(c.jsx)(l.a,{onClick:function(){var t;return i(null===(t=e.game)||void 0===t?void 0:t.pgn)},size:"sm",variant:"info",children:"PGN"}),Object(c.jsx)(l.a,{onClick:function(){var t;return h(null===(t=e.game)||void 0===t?void 0:t.whiteStrategy)},size:"sm",variant:"light",children:"White strategy"}),Object(c.jsx)(l.a,{onClick:function(){var t;return h(null===(t=e.game)||void 0===t?void 0:t.blackStrategy)},size:"sm",variant:"dark",children:"Black strategy"})]})}),Object(c.jsx)(A.a,{width:358,draggable:!1,position:e.game.fen,boardStyle:{borderRadius:"5px",boxShadow:"0 5px 15px rgba(0, 0, 0, 0.5)"}})]})}),Object(c.jsx)(Y,{pgn:a,onHide:function(){return i(void 0)},show:void 0!==a}),Object(c.jsx)(Z,{strategy:d,onHide:function(){return h(void 0)},show:void 0!==d})]}):Object(c.jsx)(w.a,{style:{height:500},children:Object(c.jsxs)(w.a.Body,{children:[Object(c.jsx)(w.a.Title,{children:"No game selected"}),Object(c.jsx)(C.a,{variant:"info",children:'Select a game from the "History" section'})]})})};var _=function(){var e=Object(r.useState)([]),t=Object(j.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(null),s=Object(j.a)(i,2),l=s[0],d=s[1],h=Object(r.useState)(0),u=Object(j.a)(h,2),g=u[0],f=u[1],m=Object(r.useState)(1),p=Object(j.a)(m,2),v=p[0],w=p[1],S=Object(r.useState)(y),k=Object(j.a)(S,2),C=k[0],F=k[1],B=Object(r.useState)(null),T=Object(j.a)(B,2),H=T[0],G=T[1];return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)(N.a,{fluid:!0,children:[Object(c.jsx)(K.a,{children:Object(c.jsx)(R.a,{children:Object(c.jsx)(E,{})})}),Object(c.jsxs)(K.a,{children:[Object(c.jsx)(R.a,{children:Object(c.jsx)($,{game:l})}),Object(c.jsx)(R.a,{children:Object(c.jsx)(J,{strategy:C,setStrategy:F,strategyFor:H,setStrategyFor:G})}),Object(c.jsx)(R.a,{children:Object(c.jsx)(D,{games:n,setGames:a,setCurrentGame:d})})]}),Object(c.jsx)(K.a,{children:Object(c.jsxs)(R.a,{children:[Object(c.jsx)(b,{nGamesToSimulate:v,onGameComplete:function(e){a((function(t){return[].concat(Object(o.a)(t),[e])})),f((function(e){return e-1}))},onSimulationStart:function(){return f((function(e){return e+1}))},strategies:{blackMoves:"b"===H?C:void 0,whiteMoves:"w"===H?C:void 0}}),Object(c.jsx)(O,{nPending:g}),Object(c.jsx)("div",{style:{width:150},children:Object(c.jsx)(x.a,{value:v,onChange:function(e){return w(parseInt(e.target.value,10))},min:1,max:1e3})})]})})]})})},ee=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,85)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};n(80),n(81),n(82);s.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(_,{})}),document.getElementById("root")),ee()}},[[83,1,2]]]);
//# sourceMappingURL=main.6e3edfec.chunk.js.map