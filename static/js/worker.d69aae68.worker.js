!function(e){var r={};function n(t){if(r[t])return r[t].exports;var o=r[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=r,n.d=function(e,r,t){n.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,r){if(1&r&&(e=n(e)),8&r)return e;if(4&r&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(n.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&r&&"string"!=typeof e)for(var o in e)n.d(t,o,function(r){return e[r]}.bind(null,o));return t},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,"a",r),r},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},n.p="/permiscuchess/",n(n.s=4)}([function(e,r,n){var t,o=n(1),i=function(e){var r="b",n="w",t=-1,i="p",a="b",f="k",u="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",l=["1-0","0-1","1/2-1/2","*"],c={b:[16,32,17,15],w:[-16,-32,-17,-15]},s={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},p=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],v=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],g={p:0,n:1,b:2,r:3,q:4,k:5},h={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},d={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},b={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},m={w:[{square:b.a1,flag:d.QSIDE_CASTLE},{square:b.h1,flag:d.KSIDE_CASTLE}],b:[{square:b.a8,flag:d.QSIDE_CASTLE},{square:b.h8,flag:d.KSIDE_CASTLE}]},y=new Array(128),E={w:t,b:t},_=n,A={w:0,b:0},S=t,w=0,C=1,I=[],T={},P={};function k(e){"undefined"===typeof e&&(e=!1),y=new Array(128),E={w:t,b:t},_=n,A={w:0,b:0},S=t,w=0,C=1,I=[],e||(T={}),P={},j(x())}function O(){for(var e=[],r={},n=function(e){e in P&&(r[e]=P[e])};I.length>0;)e.push(V());for(n(x());e.length>0;)J(e.pop()),n(x());P=r}function R(){L(u)}function L(e,o){"undefined"===typeof o&&(o=!1);var i=e.split(/\s+/),a=i[0],f=0;if(!q(e).valid)return!1;k(o);for(var u=0;u<a.length;u++){var l=a.charAt(u);if("/"===l)f+=8;else if(-1!=="0123456789".indexOf(l))f+=parseInt(l,10);else{var c=l<"a"?n:r;K({type:l.toLowerCase(),color:c},re(f)),f++}}return _=i[1],i[2].indexOf("K")>-1&&(A.w|=d.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(A.w|=d.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(A.b|=d.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(A.b|=d.QSIDE_CASTLE),S="-"===i[3]?t:b[i[3]],w=parseInt(i[4],10),C=parseInt(i[5],10),j(x()),!0}function q(e){var r="No errors.",n="FEN string must contain six space-delimited fields.",t="6th field (move number) must be a positive integer.",o="5th field (half move counter) must be a non-negative integer.",i="4th field (en-passant square) is invalid.",a="3rd field (castling availability) is invalid.",f="2nd field (side to move) is invalid.",u="1st field (piece positions) does not contain 8 '/'-delimited rows.",l="1st field (piece positions) is invalid [consecutive numbers].",c="1st field (piece positions) is invalid [invalid piece].",s="1st field (piece positions) is invalid [row too large].",p="Illegal en-passant square",v=e.split(/\s+/);if(6!==v.length)return{valid:!1,error_number:1,error:n};if(isNaN(v[5])||parseInt(v[5],10)<=0)return{valid:!1,error_number:2,error:t};if(isNaN(v[4])||parseInt(v[4],10)<0)return{valid:!1,error_number:3,error:o};if(!/^(-|[abcdefgh][36])$/.test(v[3]))return{valid:!1,error_number:4,error:i};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(v[2]))return{valid:!1,error_number:5,error:a};if(!/^(w|b)$/.test(v[1]))return{valid:!1,error_number:6,error:f};var g=v[0].split("/");if(8!==g.length)return{valid:!1,error_number:7,error:u};for(var h=0;h<g.length;h++){for(var d=0,b=!1,m=0;m<g[h].length;m++)if(isNaN(g[h][m])){if(!/^[prnbqkPRNBQK]$/.test(g[h][m]))return{valid:!1,error_number:9,error:c};d+=1,b=!1}else{if(b)return{valid:!1,error_number:8,error:l};d+=parseInt(g[h][m],10),b=!0}if(8!==d)return{valid:!1,error_number:10,error:s}}return"3"==v[3][1]&&"w"==v[1]||"6"==v[3][1]&&"b"==v[1]?{valid:!1,error_number:11,error:p}:{valid:!0,error_number:0,error:r}}function x(){for(var e=0,r="",o=b.a8;o<=b.h1;o++){if(null==y[o])e++;else{e>0&&(r+=e,e=0);var i=y[o].color,a=y[o].type;r+=i===n?a.toUpperCase():a.toLowerCase()}o+1&136&&(e>0&&(r+=e),o!==b.h1&&(r+="/"),e=0,o+=8)}var f="";A.w&d.KSIDE_CASTLE&&(f+="K"),A.w&d.QSIDE_CASTLE&&(f+="Q"),A.b&d.KSIDE_CASTLE&&(f+="k"),A.b&d.QSIDE_CASTLE&&(f+="q"),f=f||"-";var u=S===t?"-":re(S);return[r,_,f,u,w,C].join(" ")}function N(e){for(var r=0;r<e.length;r+=2)"string"===typeof e[r]&&"string"===typeof e[r+1]&&(T[e[r]]=e[r+1]);return T}function j(e){I.length>0||(e!==u?(T.SetUp="1",T.FEN=e):(delete T.SetUp,delete T.FEN))}function D(e){var r=y[b[e]];return r?{type:r.type,color:r.color}:null}function K(e,r){if(!("type"in e)||!("color"in e))return!1;if(-1==="pnbrqkPNBRQK".indexOf(e.type.toLowerCase()))return!1;if(!(r in b))return!1;var n=b[r];return(e.type!=f||E[e.color]==t||E[e.color]==n)&&(y[n]={type:e.type,color:e.color},e.type===f&&(E[e.color]=n),j(x()),!0)}function U(e,r,n,t,o){var a={color:_,from:r,to:n,flags:t,piece:e[r].type};return o&&(a.flags|=d.PROMOTION,a.promotion=o),e[n]?a.captured=e[n].type:t&d.EP_CAPTURE&&(a.captured=i),a}function Q(e){function r(e,r,n,t,o){if(e[n].type!==i||0!==Y(t)&&7!==Y(t))r.push(U(e,n,t,o));else for(var f=["q","r",a,"n"],u=0,l=f.length;u<l;u++)r.push(U(e,n,t,o,f[u]))}var n=[],t=_,o=ne(t),f={b:1,w:6},u=b.a8,l=b.h1,p=!1,v="undefined"===typeof e||!("legal"in e)||e.legal;if("undefined"!==typeof e&&"square"in e){if(!(e.square in b))return[];u=l=b[e.square],p=!0}for(var g=u;g<=l;g++)if(136&g)g+=7;else{var h=y[g];if(null!=h&&h.color===t)if(h.type===i){var m=g+c[t][0];if(null==y[m]){r(y,n,g,m,d.NORMAL);m=g+c[t][1];f[t]===Y(g)&&null==y[m]&&r(y,n,g,m,d.BIG_PAWN)}for(w=2;w<4;w++){136&(m=g+c[t][w])||(null!=y[m]&&y[m].color===o?r(y,n,g,m,d.CAPTURE):m===S&&r(y,n,g,S,d.EP_CAPTURE))}}else for(var w=0,C=s[h.type].length;w<C;w++){var I=s[h.type][w];for(m=g;!(136&(m+=I));){if(null!=y[m]){if(y[m].color===t)break;r(y,n,g,m,d.CAPTURE);break}if(r(y,n,g,m,d.NORMAL),"n"===h.type||"k"===h.type)break}}}if(!p||l===E[t]){if(A[t]&d.KSIDE_CASTLE){var T=(P=E[t])+2;null!=y[P+1]||null!=y[T]||W(o,E[t])||W(o,P+1)||W(o,T)||r(y,n,E[t],T,d.KSIDE_CASTLE)}if(A[t]&d.QSIDE_CASTLE){var P;T=(P=E[t])-2;null!=y[P-1]||null!=y[P-2]||null!=y[P-3]||W(o,E[t])||W(o,P-1)||W(o,T)||r(y,n,E[t],T,d.QSIDE_CASTLE)}}if(!v)return n;var k=[];for(g=0,C=n.length;g<C;g++)J(n[g]),$(t)||k.push(n[g]),V();return k}function M(e,r){var n="";if(e.flags&d.KSIDE_CASTLE)n="O-O";else if(e.flags&d.QSIDE_CASTLE)n="O-O-O";else{var t=function(e,r){for(var n=Q({legal:!r}),t=e.from,o=e.to,i=e.piece,a=0,f=0,u=0,l=0,c=n.length;l<c;l++){var s=n[l].from,p=n[l].to;i===n[l].piece&&t!==s&&o===p&&(a++,Y(t)===Y(s)&&f++,ee(t)===ee(s)&&u++)}if(a>0)return f>0&&u>0?re(t):u>0?re(t).charAt(1):re(t).charAt(0);return""}(e,r);e.piece!==i&&(n+=e.piece.toUpperCase()+t),e.flags&(d.CAPTURE|d.EP_CAPTURE)&&(e.piece===i&&(n+=re(e.from)[0]),n+="x"),n+=re(e.to),e.flags&d.PROMOTION&&(n+="="+e.promotion.toUpperCase())}return J(e),G()&&(F()?n+="#":n+="+"),V(),n}function B(e){return e.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function W(e,t){for(var o=b.a8;o<=b.h1;o++)if(136&o)o+=7;else if(null!=y[o]&&y[o].color===e){var a=y[o],f=o-t,u=f+119;if(p[u]&1<<g[a.type]){if(a.type===i){if(f>0){if(a.color===n)return!0}else if(a.color===r)return!0;continue}if("n"===a.type||"k"===a.type)return!0;for(var l=v[u],c=o+l,s=!1;c!==t;){if(null!=y[c]){s=!0;break}c+=l}if(!s)return!0}}return!1}function $(e){return W(ne(e),E[e])}function G(){return $(_)}function F(){return G()&&0===Q().length}function H(){return!G()&&0===Q().length}function Z(){for(var e={},r=[],n=0,t=0,o=b.a8;o<=b.h1;o++)if(t=(t+1)%2,136&o)o+=7;else{var i=y[o];i&&(e[i.type]=i.type in e?e[i.type]+1:1,i.type===a&&r.push(t),n++)}if(2===n)return!0;if(3===n&&(1===e.b||1===e.n))return!0;if(n===e.b+2){var f=0,u=r.length;for(o=0;o<u;o++)f+=r[o];if(0===f||f===u)return!0}return!1}function z(){for(var e=[],r={},n=!1;;){var t=V();if(!t)break;e.push(t)}for(;;){var o=x().split(" ").slice(0,4).join(" ");if(r[o]=o in r?r[o]+1:1,r[o]>=3&&(n=!0),!e.length)break;J(e.pop())}return n}function J(e){var n=_,o=ne(n);if(function(e){I.push({move:e,kings:{b:E.b,w:E.w},turn:_,castling:{b:A.b,w:A.w},ep_square:S,half_moves:w,move_number:C})}(e),y[e.to]=y[e.from],y[e.from]=null,e.flags&d.EP_CAPTURE&&(_===r?y[e.to-16]=null:y[e.to+16]=null),e.flags&d.PROMOTION&&(y[e.to]={type:e.promotion,color:n}),y[e.to].type===f){if(E[y[e.to].color]=e.to,e.flags&d.KSIDE_CASTLE){var a=e.to-1,u=e.to+1;y[a]=y[u],y[u]=null}else if(e.flags&d.QSIDE_CASTLE){a=e.to+1,u=e.to-2;y[a]=y[u],y[u]=null}A[n]=""}if(A[n])for(var l=0,c=m[n].length;l<c;l++)if(e.from===m[n][l].square&&A[n]&m[n][l].flag){A[n]^=m[n][l].flag;break}if(A[o])for(l=0,c=m[o].length;l<c;l++)if(e.to===m[o][l].square&&A[o]&m[o][l].flag){A[o]^=m[o][l].flag;break}S=e.flags&d.BIG_PAWN?"b"===_?e.to-16:e.to+16:t,e.piece===i||e.flags&(d.CAPTURE|d.EP_CAPTURE)?w=0:w++,_===r&&C++,_=ne(_)}function V(){var e=I.pop();if(null==e)return null;var n=e.move;E=e.kings,_=e.turn,A=e.castling,S=e.ep_square,w=e.half_moves,C=e.move_number;var t,o,a=_,f=ne(_);if(y[n.from]=y[n.to],y[n.from].type=n.piece,y[n.to]=null,n.flags&d.CAPTURE)y[n.to]={type:n.captured,color:f};else if(n.flags&d.EP_CAPTURE){var u;u=a===r?n.to-16:n.to+16,y[u]={type:i,color:f}}n.flags&(d.KSIDE_CASTLE|d.QSIDE_CASTLE)&&(n.flags&d.KSIDE_CASTLE?(t=n.to+1,o=n.to-1):n.flags&d.QSIDE_CASTLE&&(t=n.to-2,o=n.to+1),y[t]=y[o],y[o]=null);return n}function X(e,r){var n=B(e);if(r){var t=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(t)var o=t[1],i=t[2],a=t[3],f=t[4]}for(var u=Q(),l=0,c=u.length;l<c;l++){if(n===B(M(u[l]))||r&&n===B(M(u[l],!0)))return u[l];if(t&&(!o||o.toLowerCase()==u[l].piece)&&b[i]==u[l].from&&b[a]==u[l].to&&(!f||f.toLowerCase()==u[l].promotion))return u[l]}return null}function Y(e){return e>>4}function ee(e){return 15&e}function re(e){var r=ee(e),n=Y(e);return"abcdefgh".substring(r,r+1)+"87654321".substring(n,n+1)}function ne(e){return e===n?r:n}function te(e){var r=oe(e);r.san=M(r,!1),r.to=re(r.to),r.from=re(r.from);var n="";for(var t in d)d[t]&r.flags&&(n+=h[t]);return r.flags=n,r}function oe(e){var r=e instanceof Array?[]:{};for(var n in e)r[n]="object"===typeof n?oe(e[n]):e[n];return r}function ie(e){return e.replace(/^\s+|\s+$/g,"")}function ae(e){for(var r=Q({legal:!1}),n=0,t=_,o=0,i=r.length;o<i;o++){if(J(r[o]),!$(t))if(e-1>0)n+=ae(e-1);else n++;V()}return n}return L("undefined"===typeof e?u:e),{WHITE:n,BLACK:r,PAWN:i,KNIGHT:"n",BISHOP:a,ROOK:"r",QUEEN:"q",KING:f,SQUARES:function(){for(var e=[],r=b.a8;r<=b.h1;r++)136&r?r+=7:e.push(re(r));return e}(),FLAGS:h,load:function(e){return L(e)},reset:function(){return R()},moves:function(e){for(var r=Q(e),n=[],t=0,o=r.length;t<o;t++)"undefined"!==typeof e&&"verbose"in e&&e.verbose?n.push(te(r[t])):n.push(M(r[t],!1));return n},in_check:function(){return G()},in_checkmate:function(){return F()},in_stalemate:function(){return H()},in_draw:function(){return w>=100||H()||Z()||z()},insufficient_material:function(){return Z()},in_threefold_repetition:function(){return z()},game_over:function(){return w>=100||F()||H()||Z()||z()},validate_fen:function(e){return q(e)},fen:function(){return x()},board:function(){for(var e=[],r=[],n=b.a8;n<=b.h1;n++)null==y[n]?r.push(null):r.push({type:y[n].type,color:y[n].color}),n+1&136&&(e.push(r),r=[],n+=8);return e},pgn:function(e){var r="object"===typeof e&&"string"===typeof e.newline_char?e.newline_char:"\n",n="object"===typeof e&&"number"===typeof e.max_width?e.max_width:0,t=[],i=!1;for(var a in T)t.push("["+a+' "'+T[a]+'"]'+r),i=!0;i&&I.length&&t.push(r);for(var f=function(e){var r=P[x()];if("undefined"!==typeof r){var n=e.length>0?" ":"";e="".concat(e).concat(n,"{").concat(r,"}")}return e},u=[];I.length>0;)u.push(V());var l=[],c="";for(0===u.length&&l.push(f(""));u.length>0;){c=f(c);var s=u.pop();I.length||"b"!==s.color?"w"===s.color&&(c.length&&l.push(c),c=C+"."):c=C+". ...",c=c+" "+M(s,!1),J(s)}if(c.length&&l.push(f(c)),"undefined"!==typeof T.Result&&l.push(T.Result),0===n)return t.join("")+l.join(" ");var p=function(){return t.length>0&&" "===t[t.length-1]&&(t.pop(),!0)},v=function(e,i){var a,f=o(i.split(" "));try{for(f.s();!(a=f.n()).done;){var u=a.value;if(u){if(e+u.length>n){for(;p();)e--;t.push(r),e=0}t.push(u),e+=u.length,t.push(" "),e++}}}catch(l){f.e(l)}finally{f.f()}return p()&&e--,e},g=0;for(a=0;a<l.length;a++)g+l[a].length>n&&l[a].includes("{")?g=v(g,l[a]):(g+l[a].length>n&&0!==a?(" "===t[t.length-1]&&t.pop(),t.push(r),g=0):0!==a&&(t.push(" "),g++),t.push(l[a]),g+=l[a].length);return t.join("")},load_pgn:function(e,r){var n="undefined"!==typeof r&&"sloppy"in r&&r.sloppy;function t(e){return e.replace(/\\/g,"\\")}var o="object"===typeof r&&"string"===typeof r.newline_char?r.newline_char:"\r?\n",i=new RegExp("^(\\[((?:"+t(o)+")|.)*\\])(?:"+t(o)+"){2}"),a=i.test(e)?i.exec(e)[1]:"";R();var f=function(e,r){for(var n="object"===typeof r&&"string"===typeof r.newline_char?r.newline_char:"\r?\n",o={},i=e.split(new RegExp(t(n))),a="",f="",u=0;u<i.length;u++)a=i[u].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),f=i[u].replace(/^\[[A-Za-z]+\s"(.*)"\ *\]$/,"$1"),ie(a).length>0&&(o[a]=f);return o}(a,r);for(var u in f)N([u,f[u]]);if("1"===f.SetUp&&(!("FEN"in f)||!L(f.FEN,!0)))return!1;for(var c=function(e){return e=e.replace(new RegExp(t(o),"g")," "),"{".concat(function(e){return Array.from(e).map((function(e){return e.charCodeAt(0)<128?e.charCodeAt(0).toString(16):encodeURIComponent(e).replace(/\%/g,"").toLowerCase()})).join("")}(e.slice(1,e.length-1)),"}")},s=function(e){if(e.startsWith("{")&&e.endsWith("}"))return function(e){return 0==e.length?"":decodeURIComponent("%"+e.match(/.{1,2}/g).join("%"))}(e.slice(1,e.length-1))},p=e.replace(a,"").replace(new RegExp("({[^}]*})+?|;([^".concat(t(o),"]*)"),"g"),(function(e,r,n){return void 0!==r?c(r):" "+c("{".concat(n.slice(1),"}"))})).replace(new RegExp(t(o),"g")," "),v=/(\([^\(\)]+\))+?/g;v.test(p);)p=p.replace(v,"");var g=ie(p=(p=(p=p.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));g=g.join(",").replace(/,,+/g,",").split(",");for(var h="",d=0;d<g.length-1;d++){var b=s(g[d]);if(void 0===b){if(null==(h=X(g[d],n)))return!1;J(h)}else P[x()]=b}if(void 0!==(b=s(g[g.length-1]))&&(P[x()]=b,g.pop()),h=g[g.length-1],l.indexOf(h)>-1)(function(e){for(var r in e)return!0;return!1})(T)&&"undefined"===typeof T.Result&&N(["Result",h]);else{if(null==(h=X(h,n)))return!1;J(h)}return!0},header:function(){return N(arguments)},ascii:function(){return function(){for(var e="   +------------------------+\n",r=b.a8;r<=b.h1;r++){if(0===ee(r)&&(e+=" "+"87654321"[Y(r)]+" |"),null==y[r])e+=" . ";else{var t=y[r].type;e+=" "+(y[r].color===n?t.toUpperCase():t.toLowerCase())+" "}r+1&136&&(e+="|\n",r+=8)}return e+="   +------------------------+\n",e+"     a  b  c  d  e  f  g  h\n"}()},turn:function(){return _},move:function(e,r){var n="undefined"!==typeof r&&"sloppy"in r&&r.sloppy,t=null;if("string"===typeof e)t=X(e,n);else if("object"===typeof e)for(var o=Q(),i=0,a=o.length;i<a;i++)if(e.from===re(o[i].from)&&e.to===re(o[i].to)&&(!("promotion"in o[i])||e.promotion===o[i].promotion)){t=o[i];break}if(!t)return null;var f=te(t);return J(t),f},undo:function(){var e=V();return e?te(e):null},clear:function(){return k()},put:function(e,r){return K(e,r)},get:function(e){return D(e)},remove:function(e){return function(e){var r=D(e);return y[b[e]]=null,r&&r.type===f&&(E[r.color]=t),j(x()),r}(e)},perft:function(e){return ae(e)},square_color:function(e){if(e in b){var r=b[e];return(Y(r)+ee(r))%2===0?"light":"dark"}return null},history:function(e){for(var r=[],n=[],t=("undefined"!==typeof e&&"verbose"in e&&e.verbose);I.length>0;)r.push(V());for(;r.length>0;){var o=r.pop();t?n.push(te(o)):n.push(M(o)),J(o)}return n},get_comment:function(){return P[x()]},set_comment:function(e){P[x()]=e.replace("{","[").replace("}","]")},delete_comment:function(){var e=P[x()];return delete P[x()],e},get_comments:function(){return O(),Object.keys(P).map((function(e){return{fen:e,comment:P[e]}}))},delete_comments:function(){return O(),Object.keys(P).map((function(e){var r=P[e];return delete P[e],{fen:e,comment:r}}))}}};r.Chess=i,void 0===(t=function(){return i}.call(r,n,r,e))||(e.exports=t)},function(e,r,n){var t=n(2);e.exports=function(e,r){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=t(e))||r&&e&&"number"===typeof e.length){n&&(e=n);var o=0,i=function(){};return{s:i,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,f=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return f=e.done,e},e:function(e){u=!0,a=e},f:function(){try{f||null==n.return||n.return()}finally{if(u)throw a}}}}},function(e,r,n){var t=n(3);e.exports=function(e,r){if(e){if("string"===typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?t(e,r):void 0}}},function(e,r){e.exports=function(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}},function(e,r,n){"use strict";function t(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function o(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}n.r(r);var i=n(0),a=n.n(i),f=["a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a6","b6","c6","d6","e6","f6","g6","h6","a5","b5","c5","d5","e5","f5","g5","h5","a4","b4","c4","d4","e4","f4","g4","h4","a3","b3","c3","d3","e3","f3","g3","h3","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","c1","d1","e1","f1","g1","h1"],u=function(){function e(){var r;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=void 0,this.positions=void 0,this.game=new a.a;this.positions=(t(r={},this.game.WHITE,{pa:"a2",pb:"b2",pc:"c2",pd:"d2",pe:"e2",pf:"f2",pg:"g2",ph:"h2",ra:"a1",rh:"h1",nb:"b1",ng:"g1",bc:"c1",bf:"f1",k:"e1",q:"d1"}),t(r,this.game.BLACK,{pa:"a7",pb:"b7",pc:"c7",pd:"d7",pe:"e7",pf:"f7",pg:"g7",ph:"h7",ra:"a8",rh:"h8",nb:"b8",ng:"g8",bc:"c8",bf:"f8",k:"e8",q:"d8"}),r)}var r,n,i;return r=e,(n=[{key:"move",value:function(e){var r,n=this.game.turn(),t=this.positions[n],o=t[e.piece];if(!o)return!1;var i=e.destination.endsWith("1")||e.destination.endsWith("8"),a="p"===(null===(r=this.game.get(o))||void 0===r?void 0:r.type);return!!this.game.move({from:o,to:e.destination,promotion:i&&a?"q":void 0})&&(t[e.piece]=e.destination,!0)}},{key:"play",value:function(e,r){for(var n,o=this,i=(t(n={},this.game.WHITE,{ix:0,moves:e}),t(n,this.game.BLACK,{ix:0,moves:r}),n),a=function(){for(var e=o.game.turn(),r=o.game.moves({verbose:!0}),n=0,t=function(){var t=i[e].ix,a=i[e].moves[t];return i[e].ix+=1,i[e].ix%=i[e].moves.length,0===i[e].ix&&n++,2===n?{v:{v:{outcome:"w"===o.game.turn()?"black wins":"white wins",reason:"forfeit"}}}:r.find((function(r){return r.from===o.positions[e][a.piece]&&r.to===a.destination}))?(o.move(a),"break"):void 0};;){var a=t();if("break"===a)break;if("object"===typeof a)return a.v}};!this.game.game_over();){var f=a();if("object"===typeof f)return f.v}return this.game.in_checkmate()?{outcome:"w"===this.game.turn()?"black wins":"white wins",reason:"checkmate"}:{outcome:"draw",reason:this.game.in_threefold_repetition()?"threefold repetition":this.game.in_stalemate()?"stalemate":this.game.insufficient_material()?"insufficient material":"fifty move rule"}}},{key:"fen",value:function(){return this.game.fen()}},{key:"pgn",value:function(){return this.game.pgn()}}])&&o(r.prototype,n),i&&o(r,i),e}();function l(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function c(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,r){if(e){if("string"===typeof e)return l(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=["pa","pb","pc","pd","pe","pf","pg","ph","ra","rh","nb","ng","bc","bf","k","q"].flatMap((function(e){return f.map((function(r){return{piece:e,destination:r}}))})),p=function(){return function(e){for(var r=c(e),n=r.length-1;n>0;n--){var t=Math.floor(Math.random()*(n+1)),o=[r[t],r[n]];r[n]=o[0],r[t]=o[1]}return r}(s)};onmessage=function(e){var r,n,t=null!==(r=e.data.blackMoves)&&void 0!==r?r:p(),o=null!==(n=e.data.whiteMoves)&&void 0!==n?n:p(),i=new u,a=i.play(o,t),f={pgn:i.pgn(),fen:i.fen(),whiteStrategy:o,blackStrategy:t,outcome:"draw"===a.outcome?"Draw":"white wins"===a.outcome?"White wins":"Black wins",by:a.reason};postMessage(f)}}]);
//# sourceMappingURL=worker.d69aae68.worker.js.map